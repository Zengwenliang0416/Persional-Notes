# 【Git】优化Git提交脚本

## 背景

在日常开发中，我们经常需要执行Git提交操作。为了使提交过程更加规范和便捷，我们可以编写脚本来辅助这个过程。本文介绍如何优化Git提交脚本，使其支持更多功能和更好的用户体验。

## 主要功能

1. 文件选择功能
   - 支持全部提交
   - 支持交互式选择
   - 支持手动指定文件

2. 提交信息模板
   - 预定义常用的提交类型
   - 支持自定义提交类型
   - 包含表情选择功能

3. 错误处理和状态显示
   - 检查Git仓库状态
   - 显示操作进度
   - 提供清晰的错误提示

## 实现细节

### 1. 提交类型定义

脚本预定义了以下提交类型：

```plaintext
feat: ✨ 新功能
fix: 🐛 修复bug
docs: 📝 文档更新
style: 💄 代码格式
refactor: ♻️ 代码重构
perf: ⚡️ 性能优化
test: ✅ 测试相关
build: 📦 构建相关
ci: 👷 CI/CD相关
chore: 🔧 其他更改
custom: 🎨 自定义格式
```

### 2. 表情选项

提供了丰富的表情选项：

```plaintext
✨ - 新功能
🐛 - Bug修复
📝 - 文档
💄 - 样式
♻️ - 重构
⚡️ - 性能
✅ - 测试
📦 - 构建
👷 - CI/CD
🔧 - 工具
🎨 - 格式
🚀 - 部署
🆕 - 新增
🔨 - 更新
🗑️ - 删除
🔀 - 合并
🔖 - 版本
🔒 - 安全
```

### 3. 使用流程

#### 3.1 启动脚本

- Windows: 运行 `push.bat`
- Linux/macOS: 运行 `./push.sh`

#### 3.2 选择文件

1. 脚本会显示当前Git状态
2. 提供三种文件选择方式：
   ```plaintext
   1. 提交所有更改 (git add .)
   2. 交互式选择文件 (git add -p)
   3. 手动输入文件路径
   ```
3. 选择后会显示已暂存的更改

#### 3.3 提交信息构建

1. 选择提交类型：
   - 从预定义列表中选择
   - 选择"自定义格式"时可以：
     - 选择表情（可选）
     - 输入自定义提交类型

2. 输入提交描述：
   - 描述具体的更改内容
   - 不能为空

3. 最终的提交信息格式：
   ```plaintext
   <type>: <emoji> <description>
   ```
   例如：`feat: ✨ 添加用户登录功能`

#### 3.4 分支选择

1. 脚本会自动检测当前分支
2. 可以选择使用当前分支或输入其他分支名

#### 3.5 确认和执行

1. 显示即将执行的操作
2. 确认执行
3. 显示执行进度和结果

## 脚本特性

### 1. 错误处理
- 检查是否在Git仓库中
- 验证提交信息不为空
- 检查文件添加状态
- 处理推送失败情况

### 2. 用户体验
- 彩色输出提示
- 清晰的操作步骤
- 详细的状态显示
- 操作确认机制

### 3. 跨平台支持
- Windows批处理脚本 (push.bat)
- Linux/macOS shell脚本 (push.sh)

## 注意事项

1. 确保脚本具有执行权限
   ```bash
   chmod +x push.sh  # Linux/macOS
   ```

2. 如果使用自定义格式，建议遵循以下规范：
   - 类型名使用小写
   - 描述简明扼要
   - 适当使用表情增加可读性

3. 交互式选择文件时：
   - y - 暂存此块
   - n - 不暂存此块
   - q - 退出
   - s - 拆分此块
   - ? - 显示帮助

## 常见问题

1. **Q: 为什么选择交互式添加文件？**  
   A: 交互式添加允许您逐块审查更改，避免提交不必要的修改。

2. **Q: 如何修改提交类型列表？**  
   A: 直接编辑脚本中的commit_types数组。

3. **Q: 为什么要使用表情？**  
   A: 表情可以直观地表达提交的类型和目的，提高提交信息的可读性。

## 后续优化方向

1. 添加提交信息验证
2. 支持多语言
3. 添加配置文件支持
4. 集成更多Git功能
5. 添加提交历史记录

## 参考资料

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Git文档](https://git-scm.com/doc)
- [Gitmoji](https://gitmoji.dev/)
