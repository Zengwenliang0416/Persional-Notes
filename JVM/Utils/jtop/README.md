# jtop - JVM 线程监控工具

## 目录

[1. 目录](#目录)

[2. 功能特点](#功能特点)

[3. 系统要求](#系统要求)

[4. 使用方法](#使用方法)

- [4.1 基本用法](#基本用法)

- [4.2 命令行参数](#命令行参数)

- [4.3 示例](#示例)

[5. 输出说明](#输出说明)

[6. 注意事项](#注意事项)

[7. 故障排除](#故障排除)

[8. 贡献](#贡献)



## 功能特点

- 支持交互式选择要监控的 Java 进程
- 实时显示进程的线程数量
- 可配置的线程数量阈值
- 可配置的监控间隔时间
- 自动生成线程转储文件
- 支持自定义转储文件保存路径

## 系统要求

- macOS 或 Linux 操作系统
- 已安装 JDK（需要 jps 和 jstack 命令）
- Bash shell

## 使用方法

### 基本用法

```bash
./jtop
```
不带参数运行脚本时，会显示当前系统中运行的所有 Java 进程列表，供用户选择要监控的进程。

### 命令行参数

```bash
./jtop [选项]
```

可用选项：
- `-p <进程ID>`: 直接指定要监控的 Java 进程 ID
- `-t <阈值>`: 设置线程数量阈值（默认：120）
- `-i <间隔>`: 设置检查间隔秒数（默认：10）
- `-d <目录>`: 设置转储文件保存目录（默认：/tmp/jvm_dumps）
- `-h`: 显示帮助信息

### 示例

1. 交互式选择进程：
   ```bash
   ./jtop
   ```

2. 监控指定进程，设置阈值为 200：
   ```bash
   ./jtop -p 1234 -t 200
   ```

3. 自定义检查间隔和转储目录：
   ```bash
   ./jtop -i 30 -d /path/to/dumps
   ```

## 输出说明

脚本运行时会显示以下信息：
- 当前监控的进程 ID
- 设置的线程数阈值
- 检查间隔时间
- 转储文件保存路径
- 实时的线程数量统计

当线程数超过阈值时，会自动生成线程转储文件，文件名格式为：
```
threaddump_[PID]_[时间戳].txt
```

## 注意事项

1. 需要有足够的权限访问目标 Java 进程
2. 建议将转储文件保存在有足够磁盘空间的位置
3. 可以使用 Ctrl+C 随时停止监控

## 故障排除

1. 如果出现 "未找到进程" 错误，请确认：
   - 进程 ID 是否正确
   - 是否有权限访问该进程

2. 如果无法生成转储文件，请检查：
   - 是否有写入目标目录的权限
   - 磁盘空间是否充足

## 贡献

欢迎提交问题报告和改进建议。
